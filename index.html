<!-- This work is licensed under the W3C Software and Document License
     (http://www.w3.org/Consortium/Legal/2015/copyright-software-and-document).
  -->
  <!DOCTYPE html>
  <html>
  
  <head>
      <title>
          Web Share Test
      </title>
      <meta name="viewport" content="width=device-width">
      <style>
          .error {
              color: #d22;
          }
  
          input[type="button"] {
              height: 30px
          }
      </style>
  </head>
  
  <body>
      <h1>
          Web Share Test
      </h1>
      <table>
          <tr>
              <td>
                  Files:
              </td>
              <td>
                  <!--Without column 2, the whole table is small on mobile.-->
              </td>
              <td>
                  <input id="files" type="file" multiple>
              </td>
          </tr>
      </table>
      <p>
          <input id="share" type="button" value="Share">
      </p>
      <div id="output"></div>
      <script>
          'use strict';
  
          function checkboxChanged(e) {
              const checkbox = e.target;
              const textfield = document.querySelector('#' + checkbox.id.split('_')[0]);
  
              textfield.disabled = !checkbox.checked;
              if (!checkbox.checked)
                  textfield.value = '';
          }
  
          async function testWebShare() {
              const file_input = document.querySelector('#files');
              const files = file_input.disabled ? undefined : file_input.files;
  
              try {
                  await navigator.share({
                      files, title: 'Thông báo giao dịch',
                      text: 'Chia sẻ thông báo giao dịch'
                  });
                  logText('Successfully sent share');
              } catch (error) {
                  logError('Error sharing: ' + error);
              }
          }
  
          function onLoad() {
              document.querySelector('#share').addEventListener('click', testWebShare);
              if (navigator.share === undefined) {
                  if (window.location.protocol === 'http:') {
                      // navigator.share() is only available in secure contexts.
                      window.location.replace(window.location.href.replace(/^http:/, 'https:'));
                  } else {
                      logError('Error: You need to use a browser that supports this draft ' +
                          'proposal.');
                  }
              }
          }
  
          window.addEventListener('load', onLoad);
      </script>
  </body>
  
  </html>
